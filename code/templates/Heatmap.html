<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>标签-难度热力图</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
       #heatmap-container {
            /* 修改1：增大容器宽度并添加最小宽度限制 */
            width: 1600px;
            min-width: 1400px;
            height: 800px;
            margin: 0 auto;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div id="heatmap-container"></div>

    <script>
        // 获取Django传递的数据
        var tagList = {{ tag_list|safe }};
        var difficultList = {{ difficult_list|safe }};
        var num = {{ num|safe }};
        console.log("标签列表:", tagList)
        console.log("难度列表:", difficultList)
        console.log("难度列表:", num)
        // 初始化图表
        var chart = echarts.init(document.getElementById('heatmap-container'));

        // 配置项
        var option = {
            title: {
                text: '标签-难度分布热力图',
                left: 'center'
            },
            tooltip: {
                position: 'top',
                formatter: function (params) {
                    return tagList[params.value[0]] + '-' +
                           difficultList[params.value[1]] + ': ' +
                           params.value[2];
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '20%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: tagList,
                splitArea: {
                    show: true
                },
                axisLabel: {
                    rotate: 45,         // 标签倾斜45度
                    interval: 0,        // 强制显示所有标签
                    width: 100,         // 标签最大宽度
                    overflow: 'truncate', // 超长标签显示省略号
                    fontSize: 12        // 调整字号
                },
                axisTick: {
                    alignWithLabel: true // 刻度与标签对齐
                }
            },
            yAxis: {
                type: 'category',
                data: difficultList,
                splitArea: {
                    show: true
                }
            },
            visualMap: {
                min: 0,
                max: 100,  // 根据你的数据最大值调整
                calculable: true,
                orient: 'horizontal',
                left: 'center',
                bottom: '8%',
                inRange: {
                    color: ['#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695']
                }
            },
            series: [{
                name: '数量',
                type: 'heatmap',
                data: num,
                label: {
                    show: true,
                    formatter: function(params) {
                        return params.value[2];
                    }
                },
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }]
        };

        // 使用配置项显示图表
        chart.setOption(option);

        // 响应窗口大小变化
        window.addEventListener('resize', function() {
            chart.resize();
        });
    </script>
</body>
</html>